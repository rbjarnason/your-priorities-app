<html><head><script type="module" src="../../../../@polymer/polymer/polymer-legacy.js"></script><script type="module" src="../../../../@polymer/iron-flex-layout/iron-flex-layout-classes.js"></script><script type="module" src="../../../../@polymer/paper-icon-button/paper-icon-button.js"></script><script type="module" src="../yp-app-globals/yp-app-icons.js"></script><script type="module" src="../yp-behaviors/yp-language-behavior.js"></script><script type="module" src="../yp-user/yp-user-image.js"></script><script type="module" src="../yp-ajax/yp-ajax.js"></script></head><body><dom-module id="yp-post-users"><template><style include="iron-flex iron-flex-alignment">:host{display:block;}.users{@apply --layout-horizontal;}yp-user-image{padding:2px;}</style><template is="dom-if" restamp="true" if="[[endorsements]]"><div class="users"><template is="dom-repeat" items="[[limitFrom(endorsements, 0, userImagesLimit)]]" as="endorsement" index-as="endorsementIndex"><yp-user-image small="" no-default="" user="[[endorsement.User]]"></yp-user-image></template><div id="moreImages" style="display:none;"><paper-icon-button aria-label$="[[t('addImage')]]" class="more" id="moreImagesButton" icon="add" on-tap="_moreUserImages"></paper-icon-button><span id="numberOfMoreUserImages">[[_userImagesCount()]]</span> <span id="restOfUserImages" style="display: none;"><template is="dom-repeat" items="[[limitFrom(endorsements, userImagesLimit, endorsements.length)]]" as="endorsement" index-as="endorsementIndex"><yp-user-image user="[[endorsement.User]]" small=""></yp-user-image></template></span></div></div></template><yp-ajax id="endorsementAjax" use-dialog="false" on-response="_response" handle-as="json"></yp-ajax></template><script type="module">import"../../node_modules/@polymer/polymer/polymer-legacy.js";import"../../node_modules/@polymer/iron-flex-layout/iron-flex-layout-classes.js";import"../../node_modules/@polymer/paper-icon-button/paper-icon-button.js";import"../yp-app-globals/yp-app-icons.js";import{ypLanguageBehavior}from"../yp-behaviors/yp-language-behavior.js";import"../yp-user/yp-user-image.js";import"../yp-ajax/yp-ajax.js";import{Polymer}from"../../node_modules/@polymer/polymer/lib/legacy/polymer-fn.js";Polymer({is:"yp-post-users",behaviors:[ypLanguageBehavior],properties:{endorsements:{type:Array,notify:!0},shownEndorsements:{type:Array,notify:!0},userImagesLimit:{type:Number,value:10},post:{type:Object,observer:"_postChanged"}},limitFrom:function limitFrom(input,offset,limit){if(!babelHelpers.instanceof(input,Array)&&!babelHelpers.instanceof(input,String))return input;limit=parseInt(limit,10);if(babelHelpers.instanceof(input,String)){if(limit){return 0<=limit?input.slice(offset,limit):input.slice(limit,input.length)}else{return""}}var out=[],i,n;if(limit>input.length)limit=input.length;else if(limit<-input.length)limit=-input.length;if(0<limit){i=offset;n=limit}else{i=input.length+limit;n=input.length}for(;i<n;i++){out.push(input[i])}return out},addEndorsement:function addEndorsement(endorsement){if(this.endorsements){this.endorsements.unshift(endorsement)}},_postChanged:function _postChanged(newValue,oldValue){if(newValue){this.set("endorsements",null);this.$.endorsementAjax.url=this._computeUrl(newValue);this.$.endorsementAjax.generateRequest()}else{this.set("endorsements",null)}},_response:function _response(event,detail,sender){this.set("endorsements",detail.response);if(this.endorsements.length>this.userImagesLimit){this.async(function(){this.$$("#moreImages").style.display="inline"},100)}},_moreUserImages:function _moreUserImages(){this.$$("#moreImagesButton").style.display="none";this.$$("#numberOfMoreUserImages").style.display="none";this.$$("#restOfUserImages").style.display="inline"},_computeUrl:function _computeUrl(post){return"/api/posts/"+post.id+"/endorsements"},allEndorsementsLength:function allEndorsementsLength(post){return this.endorsements.length},countUserImagesLeft:function countUserImagesLeft(e){return this.allEndorsementsLength(this.post)-this.userImagesLimit},_userImagesCount:function _userImagesCount(){return this.countUserImagesLeft(0)}});</script></dom-module></body></html>