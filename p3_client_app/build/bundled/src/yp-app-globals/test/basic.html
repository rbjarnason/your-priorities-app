<!DOCTYPE html><html><head><meta charset="UTF-8"><title>yp-app-globals tests</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><script>if(!window.customElements){document.write("<!--")}</script><script type="text/javascript" src="../../../../../@webcomponents/webcomponentsjs/custom-elements-es5-adapter.js"></script><!--! do not remove --><script src="../../../../../@webcomponents/webcomponentsjs/webcomponents-bundle.js"></script><script src="../../../../../wct-browser-legacy/browser.js"></script><script src="../../../../../@polymer/test-fixture/test-fixture-mocha.js"></script><script type="module" src="../../../../../@polymer/test-fixture/test-fixture.js"></script><script type="text/javascript" src="../../i18next-1.7.4.min.js"></script><script type="module" src="../yp-app-globals.js"></script><style include="iron-flex iron-flex-alignment">body{margin:0;padding:0;}</style></head><body><test-fixture id="basic"><template><yp-app-globals></yp-app-globals></template></test-fixture><test-fixture id="resetSeenWelcome"><template><yp-app-globals reset-seen-welcome=""></yp-app-globals></template></test-fixture><script type="module">import"../../../node_modules/@polymer/test-fixture/test-fixture.js";import"../yp-app-globals.js";suite("basic",function(){var responseHeaders={json:{"Content-Type":"application/json"}},ajax,request,server;setup(function(){server=sinon.fakeServer.create();server.respondWith("GET",/\/activity-stream\/activity\/?timestamp=*/,[200,responseHeaders,"{\"status\":\"ok\"}"]);server.autoRespond=!0;i18n.init({lng:"en"});window.i18n=i18n});teardown(function(){server.restore()});test("can access through window.global",function(){var globals=fixture("basic"),windowAppGlobals=window.appGlobals;expect(windowAppGlobals.localName).to.be.ok;expect(windowAppGlobals.localName).to.be.equal("yp-app-globals")});test("automatically open welcome dialog when new",function(done){var globals=fixture("resetSeenWelcome");this.async(function(){var welcomeDialog=globals.querySelector("#welcomeDialog");expect(welcomeDialog.opened).to.be.equal(!0);var seenWelcomeButton=globals.querySelector("#seenWelcomeButton");seenWelcomeButton.click();this.async(function(){expect(welcomeDialog.opened).to.be.equal(!1);done()})})});test("welcome dialog closed on second use",function(done){var globalsTwo=fixture("basic");this.async(function(){var welcomeDialog=globalsTwo.querySelector("#welcomeDialog");expect(welcomeDialog.opened).to.be.equal(!1);done()})});test("can send activity",function(done){var globals=fixture("basic"),windowAppGlobals=window.appGlobals;windowAppGlobals.activity("actor","verb","object","context");this.async(function(){var request=server.requests[2];expect(request.requestBody).to.include("actor");expect(request.requestBody).to.include("verb");expect(request.requestBody).to.include("object");expect(request.requestBody).to.include("context");done()})});test("can open default dialogue and close it",function(done){var globals=fixture("basic"),defaultDialog=globals.querySelector("#dialog");globals.openDialog("this.is.test");this.async(function(){expect(defaultDialog.opened).to.be.equal(!0);expect(defaultDialog.innerHTML).to.include("this.is.test");var defaultOkButton=globals.querySelector("#defaultOkButton");defaultOkButton.click();this.async(function(){expect(defaultDialog.opened).to.be.equal(!1);done()})})})});</script></body></html>